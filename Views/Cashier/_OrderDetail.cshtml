@model RestaurantMVC.Models.Order

@if (Model == null)
{
    <p>âŒ BÃ n nÃ y hiá»‡n khÃ´ng cÃ³ Ä‘Æ¡n hÃ ng Ä‘ang phá»¥c vá»¥.</p>
}
else
{
    <h5>ğŸª‘ ÄÆ¡n hÃ ng cho bÃ n @Model.MaBan</h5>
    <table class="table table-bordered mt-3">
        <thead class="table-light">
            <tr>
                <th>MÃ³n Äƒn</th>
                <th>Sá»‘ lÆ°á»£ng</th>
                <th>ÄÆ¡n giÃ¡</th>
                <th>ThÃ nh tiá»n</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var ct in Model.ChiTietOrders)
        {
            <tr>
                <td>@ct.MonAn.TenMon</td>
                <td>@ct.SoLuong</td>
                <td>@String.Format("{0:N0} Ä‘", ct.DonGia)</td>
                <td>@String.Format("{0:N0} Ä‘", ct.SoLuong * ct.DonGia)</td>
            </tr>
        }
        </tbody>
    </table>

    var tong = Model.ChiTietOrders.Sum(x => x.SoLuong * x.DonGia);
    <h5 class="text-end mt-3">Tá»•ng cá»™ng: <strong>@String.Format("{0:N0} Ä‘", tong)</strong></h5>

    <div class="text-end mt-3">
        <button class="btn btn-success" onclick="openPayment(@Model.MaBan)">ğŸ’µ Thanh toÃ¡n</button>
    </div>

    <div id="paymentModalContainer"></div>
}
<script>
function openPayment(tableId){
    $("#paymentModalContainer").load(`/Cashier/PayModal?tableId=${tableId}`, () => {
        const modal = new bootstrap.Modal(document.getElementById("paymentModal"));
        modal.show();
    });
}
</script>
